#!/bin/sh

dirname=`dirname $0`

if [ `echo $dirname | grep "^/" -c` -eq 1 ]; then
        path=$dirname/..
else
        cd `pwd`/$dirname/.. > /dev/null
        path=`pwd`
        cd - > /dev/null
fi

export PYTHONPATH=$path/lib:/usr/share/exabgp
export ETC=$path/etc/exabgp

PYTHON=`which python`
PYPY=`which pypy`

if [ -f "$PYPY" ]
then
	INTERPRETER=$PYPY
elif [ -f "$PYTHON" ]
then
	INTERPRETER=$PYTHON
else
	INTERPRETER=python
fi

APPLICATIONS=`python -c "import sys,os; print ' '.join(os.path.join(_,'exabgp','application.py') for _ in sys.path if os.path.isfile('/'.join((_,'exabgp/application.py'))))"`
APPLICATION=`echo $APPLICATIONS | awk '{ print $1; }'`

$INTERPRETER -m exabgp.debug $APPLICATION $*
