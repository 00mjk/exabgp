#!/bin/sh

# exit if any command fails
set -e

dirname=`dirname $0`
retval=0

case $dirname in
	/*)
		cd $dirname/../.. > /dev/null
		path=`pwd`
		cd - > /dev/null
	;;
	*)
		cd `pwd`/$dirname/../.. > /dev/null
		path=`pwd`
		cd - > /dev/null
	;;
esac

export PYTHONPATH=$path/src
# a weird packet from Cisco 7600 with attribute not no NLRI (so not an EOR, just a junk, unless packet)
$path/sbin/exabgp decode -f 'ipv4 unicast' ffffffffffffffffffffffffffffffff004f02000000384001010040020e02030000aaaa0000aaaa0000aaaac0070800aa00aa0a0a0a0a4006004003040a0a0a0a8004040000000040050400000064

# a simple ipv4 route
$path/sbin/exabgp decode -f 'ipv4 unicast'  FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF:003C:02:0000001C4001010040020040030465016501800404000000C840050400000064000000002001010101

# decoding bgp-ls
$path/sbin/exabgp decode -f 'bgp-ls bgp-ls' --nlri "00 02 FF FF 03 00 00 00 00 00 00 00 00 01 00 00 20 02 00 00 04 00 00 00 01 02 01 00 04 c0 a8 7a 7e 02 02 00 04 00 00 00 00 02 03 00 04 0a 0a 0a 0a 01 01 00 20 02 00 00 04 00 00 00 01 02 01 00 04 c0 a8 7a 7e 02 02 00 04 00 00 00 00 02 03 00 04 0a 02 02 02"
$path/sbin/exabgp decode -d -f 'bgp-ls bgp-ls' '0000 0093 800E 7240 0447 04C0 A8FF 1D00 0002 0065 0300 0000 0000 0000 0001 0000 2002 0000 0400 00FD E902 0100 0400 0000 0002 0200 0400 0000 0002 0300 040A 0101 0101 0100 2402 0000 0400 00FD E902 0100 0400 0000 0002 0200 0400 0000 0002 0300 080A 0104 010A 0101 0201 0300 040A 0101 0101 0400 040A 0101 0240 0101 0040 0206 0201 0000 FDE9 8004 0400 0000 0080 1D07 0447 0003 0000 01'
$path/sbin/exabgp decode -f 'bgp-ls bgp-ls' '0000 0098 4001 0100 4002 0040 0504 0000 0064 8009 04C0 A8FC B280 0A04 0C04 0101 801D 1301 0200 0800 0001 7200 0001 BB04 4700 0300 1388 900E 0062 4004 4704 C0A8 FCB2 0000 0200 5502 0000 0000 0000 0002 0100 001A 0200 0004 0000 0D18 0201 0004 0000 00B2 0203 0006 1921 6825 2240 0101 001A 0200 0004 0000 0D18 0201 0004 0000 00B2 0203 0006 1921 6825 2162 0103 0004 C0A8 C754 0104 0004 C0A8 C755'
$path/sbin/exabgp decode -f 'bgp-ls bgp-ls' '0000 00B8 4001 0100 4002 0040 0504 0000 0064 801D 6104 4000 0400 0000 0004 4100 044C EE6B 2804 4200 044C EE6B 2804 4300 204C EE6B 284C EE6B 284C EE6B 284C EE6B 284C EE6B 284C EE6B 284C EE6B 284C EE6B 2804 4400 0400 0000 1404 4700 0300 000A 044B 0007 3000 0000 0493 1004 4B00 0770 0000 0004 9300 900E 0042 4004 4704 C0A8 74C9 0000 0200 3502 0000 0000 0000 0000 0100 000A 0203 0006 0001 0000 0001 0101 000A 0203 0006 0001 0000 0002 0103 0004 0A00 0000 0104 0004 0A00 0001'
